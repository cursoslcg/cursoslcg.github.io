<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Archivos GenBank <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:dodgerblue;overflow:visible;position:relative;"><path d="M416 0c17.7 0 32 14.3 32 32c0 59.8-30.3 107.5-69.4 146.6c-28 28-62.5 53.5-97.3 77.4l-2.5 1.7c-11.9 8.1-23.8 16.1-35.5 23.9l0 0 0 0 0 0-1.6 1c-6 4-11.9 7.9-17.8 11.9c-20.9 14-40.8 27.7-59.3 41.5H283.3c-9.8-7.4-20.1-14.7-30.7-22.1l7-4.7 3-2c15.1-10.1 30.9-20.6 46.7-31.6c25 18.1 48.9 37.3 69.4 57.7C417.7 372.5 448 420.2 448 480c0 17.7-14.3 32-32 32s-32-14.3-32-32H64c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-59.8 30.3-107.5 69.4-146.6c28-28 62.5-53.5 97.3-77.4c-34.8-23.9-69.3-49.3-97.3-77.4C30.3 139.5 0 91.8 0 32C0 14.3 14.3 0 32 0S64 14.3 64 32H384c0-17.7 14.3-32 32-32zM338.6 384H109.4c-10.1 10.6-18.6 21.3-25.5 32H364.1c-6.8-10.7-15.3-21.4-25.5-32zM109.4 128H338.6c10.1-10.7 18.6-21.3 25.5-32H83.9c6.8 10.7 15.3 21.3 25.5 32zm55.4 48c18.4 13.8 38.4 27.5 59.3 41.5c20.9-14 40.8-27.7 59.3-41.5H164.7z"/></svg> <svg aria-hidden="true" role="img" viewBox="0 0 384 512" style="height:1em;width:0.75em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:lemonChiffon ;overflow:visible;position:relative;"><path d="M365.3 93.38l-74.63-74.64C278.6 6.742 262.3 0 245.4 0L64-.0001c-35.35 0-64 28.65-64 64l.0065 384c0 35.34 28.65 64 64 64H320c35.2 0 64-28.8 64-64V138.6C384 121.7 377.3 105.4 365.3 93.38zM336 448c0 8.836-7.164 16-16 16H64.02c-8.838 0-16-7.164-16-16L48 64.13c0-8.836 7.164-16 16-16h160L224 128c0 17.67 14.33 32 32 32h79.1V448zM96 280C96 293.3 106.8 304 120 304h144C277.3 304 288 293.3 288 280S277.3 256 264 256h-144C106.8 256 96 266.8 96 280zM264 352h-144C106.8 352 96 362.8 96 376s10.75 24 24 24h144c13.25 0 24-10.75 24-24S277.3 352 264 352z"/></svg></title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs-2.18/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/hygge.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Archivos GenBank <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:dodgerblue;overflow:visible;position:relative;"><path d="M416 0c17.7 0 32 14.3 32 32c0 59.8-30.3 107.5-69.4 146.6c-28 28-62.5 53.5-97.3 77.4l-2.5 1.7c-11.9 8.1-23.8 16.1-35.5 23.9l0 0 0 0 0 0-1.6 1c-6 4-11.9 7.9-17.8 11.9c-20.9 14-40.8 27.7-59.3 41.5H283.3c-9.8-7.4-20.1-14.7-30.7-22.1l7-4.7 3-2c15.1-10.1 30.9-20.6 46.7-31.6c25 18.1 48.9 37.3 69.4 57.7C417.7 372.5 448 420.2 448 480c0 17.7-14.3 32-32 32s-32-14.3-32-32H64c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-59.8 30.3-107.5 69.4-146.6c28-28 62.5-53.5 97.3-77.4c-34.8-23.9-69.3-49.3-97.3-77.4C30.3 139.5 0 91.8 0 32C0 14.3 14.3 0 32 0S64 14.3 64 32H384c0-17.7 14.3-32 32-32zM338.6 384H109.4c-10.1 10.6-18.6 21.3-25.5 32H364.1c-6.8-10.7-15.3-21.4-25.5-32zM109.4 128H338.6c10.1-10.7 18.6-21.3 25.5-32H83.9c6.8 10.7 15.3 21.3 25.5 32zm55.4 48c18.4 13.8 38.4 27.5 59.3 41.5c20.9-14 40.8-27.7 59.3-41.5H164.7z"/></svg> <svg aria-hidden="true" role="img" viewBox="0 0 384 512" style="height:1em;width:0.75em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:lemonChiffon ;overflow:visible;position:relative;"><path d="M365.3 93.38l-74.63-74.64C278.6 6.742 262.3 0 245.4 0L64-.0001c-35.35 0-64 28.65-64 64l.0065 384c0 35.34 28.65 64 64 64H320c35.2 0 64-28.8 64-64V138.6C384 121.7 377.3 105.4 365.3 93.38zM336 448c0 8.836-7.164 16-16 16H64.02c-8.838 0-16-7.164-16-16L48 64.13c0-8.836 7.164-16 16-16h160L224 128c0 17.67 14.33 32 32 32h79.1V448zM96 280C96 293.3 106.8 304 120 304h144C277.3 304 288 293.3 288 280S277.3 256 264 256h-144C106.8 256 96 266.8 96 280zM264 352h-144C106.8 352 96 362.8 96 376s10.75 24 24 24h144c13.25 0 24-10.75 24-24S277.3 352 264 352z"/></svg>
]
.institute[
### Licenciatura en Ciencias Genómicas, UNAM
]
.date[
### First version: 2021-08-15; Last update: 2023-08-07
]

---



&lt;style type="text/css"&gt;
/* From https://github.com/yihui/xaringan/issues/147  */
.scroll-output {
  height: 80%;
  overflow-y: scroll;
}
/* https://stackoverflow.com/questions/50919104/horizontally-scrollable-output-on-xaringan-slides */
pre {
  max-width: 100%;
  overflow-x: scroll;
}
&lt;/style&gt;

### Genbank

"GeneBank es la abreviatura de Gene Bank El **formato de archivo GENBANK** está asociado a guardar información de **secuenciación de ADN y proteínas**. Esta información puede estar vinculada a una o varias secuencias. El formato de archivo GenBank es muy **utilizado por muchas bases de datos públicas**, ya que está reconocido como el formato de archivo estándar para almacenar datos de secuencias de ADN y proteínas.

Los archivos GenBank pertenecen principalmente a Genome Compiler de Genome Compiler. El tipo de archivo GenBank es un tipo de archivo asociado a guardar datos relacionados con la bioinformática y fue desarrollado por el Centro Nacional de Información Biotecnológica de EE.UU. (NCBI). "


[source: https://filext.com/es/extension-de-archivo/GENBANK]

---

### GenBank
https://www.ncbi.nlm.nih.gov/Sitemap/samplerecord.html
&lt;img src="imgs/clase_2/gb_file.png" width="450px" style="display: block; margin: auto;" /&gt;
---
### GenBank
&lt;img src="imgs/clase_2/problema.png" width="850px" style="display: block; margin: auto;" /&gt;
---

### GenBank

.content-box-red[.small[**Metadata**:
Información detallada sobre el organismo, referencias  a otras bases de datos, publicaciones, etc.]]



```
## LOCUS       JN584162                 500 bp ss-RNA     linear   VRL 15-APR-2012
## DEFINITION  Aichi virus isolate 462 VP1 gene, partial cds.
## ACCESSION   JN584162
## VERSION     JN584162.1
## KEYWORDS    .
## SOURCE      Aichi virus 1
##   ORGANISM  Aichi virus 1
##             Viruses; Riboviria; Orthornavirae; Pisuviricota; Pisoniviricetes;
##             Picornavirales; Picornaviridae; Kobuvirus.
## REFERENCE   1  (bases 1 to 500)
##   AUTHORS   Jonsson,N., Wahlstrom,K., Svensson,L., Serrander,L. and
##             Lindberg,A.M.
##   TITLE     Aichi virus infection in elderly people in Sweden
##   JOURNAL   Arch. Virol. (2012) In press
##    PUBMED   22466255
##   REMARK    Publication Status: Available-Online prior to print
## REFERENCE   2  (bases 1 to 500)
```
---
### GenBank 

.content-box-red[.small[**Features**:
Características importantes de la secuencia, como secuencias codificantes, proteínas, etc.]]

```
## FEATURES             Location/Qualifiers
##      source          1..500
##                      /organism="Aichi virus 1"
##                      /mol_type="genomic RNA"
##                      /isolate="462"
##                      /isolation_source="feces"
##                      /host="Homo sapiens"
##                      /db_xref="taxon:1313215"
##                      /country="Sweden"
##                      /collection_date="2009"
##      CDS             &lt;1..&gt;500
##                      /codon_start=3
##                      /product="VP1"
##                      /protein_id="AFH54897.1"
##                      /translation="PPDTKLENFFSFYRLLPMGGSGAPALSFPADEGTIIPLNPINWL
##                      KGADVSGIAAMLSCFTYIAADLRITLRFSNPNDNPATMLVAFAPPGATIPLKPTRQML
##                      SNFYMAEVPVSAATSTMVSFSIPYTSPLSAIPTSYFGWEDWSGTNFGQLSSGSWGNLM
##                      LIPSLS"
```
---

### GenBank
.content-box-red[.small[**Origin**:
Secuencia (ADN o proteína). La última línea es un "//" e indican el final del archivo.]]

```
## ORIGIN
##         1 tccctccaga caccaaactg gaaaacttct tctccttcta ccgcttgctg cccatgggtg
##        61 gcagcggtgc tccagctctt tctttccccg ctgacgaagg cacaatcatc ccactcaacc
##       121 caatcaattg gctcaaaggg gcggacgtct ccgggatcgc tgcgatgcta tcgtgcttca
##       181 cgtacatcgc tgcggacctg cgaatcacgc tccgcttctc caacccaaat gacaaccctg
##       241 ccaccatgct tgttgccttc gctccccctg gcgccaccat ccccctcaaa cccacgcgcc
##       301 aaatgctctc caacttctac atggcggagg tcccagtctc cgctgccacc tccaccatgg
##       361 tctctttctc catcccctac acctcccccc tctctgccat ccccacctca tacttcggat
##       421 gggaggactg gtcaggtacc aactttggcc agctctcctc cgggtcatgg ggaaacctca
##       481 tgctcatccc ctctctctct
## //
```
---
# Múltiples registros en un archivo GenBank
&lt;img src="imgs/clase_2/registros.png" width="350px" style="display: block; margin: auto;" /&gt;
---
# Escenario 

Desde la base de datos Nucloetide de NCBI se ha [descargado un archivo](https://www.ncbi.nlm.nih.gov/nuccore/JN584162.1/) en formato Genbank. Puedes descargarlo desde la platforma del curso, el archivo se llama `aichi.gb` o bien descargarlo desde la liga, y salvarlo en formato `GenBank`

Vamos a extraer la información de ese archivo.

---
# Obtener la información del archivo GenBank

1. Primero importamos el **módulo** `SeqIO` para poder trabajar con **objetos** `SeqRecord`
```{}
desde Bio importar SeqIO 
```

2. Ahora, utilizamos la función `parse` que recibe el nombre del archivo y el formato (genbank)
```{}
Para Cada registro en SeqIO.parse("nombre_archivo.gb", "genbank"):
  imprime('ID', registro.id)
```

&lt;p&gt;&lt;samp&gt;## ID id_registro_1 (información de un virus)&lt;br&gt;## ID id_registro_2 (información de un animal) &lt;/samp&gt;&lt;/p&gt;

---
# Obtener la información del archivo GenBank

```python
from Bio import SeqIO

for gb_record in SeqIO.parse("./files/clase_2/aichi.gb", "genbank"):
    print('ID', gb_record.id)
    print('Secuencia', str(gb_record.seq)[0:30],'...')
    print('Longitud', len(gb_record))
```

```
## ID JN584162.1
## Secuencia TCCCTCCAGACACCAAACTGGAAAACTTCT ...
## Longitud 500
```

```python
atributos = gb_record.__dict__
atributos.keys()
```

```
## dict_keys(['_seq', 'id', 'name', 'description', 'dbxrefs', 'annotations', '_per_letter_annotations', 'features'])
```
---
# GenBank annotations (metadata)
&lt;img src="imgs/clase_2/metadatos.png" width="450px" style="display: block; margin: auto;" /&gt;
---
# GenBank annotations (metadata)
Primero accedemos al atributo `annotations`. Aquí están almacenada la información de metadata en forma de dicciónario:

```{}
registro.annotations
```
&lt;p&gt;&lt;samp&gt;## {llave_metadato_1 : valor_metadato_1,&lt;br&gt;##  llave_metadato_2 : valor_metadato_2,&lt;br&gt;&lt;mark&gt;## fecha : 15-APR-2012}&lt;/mark&gt;&lt;/samp&gt;&lt;/p&gt;

--

Accedo como a cualquier diccionario:

```{}
registro.annotations['llave_metadato_1']
```

&lt;p&gt;&lt;samp&gt;## valor_metadato_1 &lt;/samp&gt;&lt;/p&gt;

```{}
registro.annotations['fecha']
```

&lt;p&gt;&lt;samp&gt;## 15-APR-2012 &lt;/samp&gt;&lt;/p&gt;

---
# GenBank annotations (metadata)


```python
for annotation, value in gb_record.annotations.items():
  print(annotation, value)
```

```
## molecule_type ss-RNA
## topology linear
## data_file_division VRL
## date 15-APR-2012
## accessions ['JN584162']
## sequence_version 1
## keywords ['']
## source Aichi virus 1
## organism Aichi virus 1
## taxonomy ['Viruses', 'Riboviria', 'Orthornavirae', 'Pisuviricota', 'Pisoniviricetes', 'Picornavirales', 'Picornaviridae', 'Kobuvirus']
## references [Reference(title='Aichi virus infection in elderly people in Sweden', ...), Reference(title='Direct Submission', ...)]
```

```python
  
gb_record.annotations['date']
```

```
## '15-APR-2012'
```
---
# &lt;span style="color:Plum"&gt;Ejercicio 4&lt;/span&gt;

#### &lt;span style="color:Orchid"&gt;Obtener información de las anotaciones&lt;/span&gt;

* Utilizando el archivo **virus.gb** obtengan de qué organismo viene  y la fecha.


```python
## molecule_type ss-RNA
## topology linear
## data_file_division VRL
*## date 15-APR-2012
## accessions ['JN584162']
## sequence_version 1
## keywords ['']
## source Aichi virus 1
*## organism Aichi virus 1
## taxonomy ['Viruses', 'Riboviria', 'Orthornavirae', 'Pisuviricota', 'Pisoniviricetes', 'Picornavirales', 'Picornaviridae', 'Kobuvirus']
## references [Reference(title='Aichi virus infection in elderly people in Sweden', ...), Reference(title='Direct Submission', ...)]`
```
---
# GenBank features
&lt;img src="imgs/clase_2/features.png" width="450px" style="display: block; margin: auto;" /&gt;
---
# GenBank features


```
## FEATURES             Location/Qualifiers
##      source          1..500
##                      /organism="Aichi virus 1"
##                      /mol_type="genomic RNA"
##                      /isolate="462"
##                      /isolation_source="feces"
##                      /host="Homo sapiens"
##                      /db_xref="taxon:1313215"
##                      /country="Sweden"
##                      /collection_date="2009"
##      CDS             &lt;1..&gt;500
##                      /codon_start=3
##                      /product="VP1"
##                      /protein_id="AFH54897.1"
##                      /translation="PPDTKLENFFSFYRLLPMGGSGAPALSFPADEGTIIPLNPINWL
##                      KGADVSGIAAMLSCFTYIAADLRITLRFSNPNDNPATMLVAFAPPGATIPLKPTRQML
##                      SNFYMAEVPVSAATSTMVSFSIPYTSPLSAIPTSYFGWEDWSGTNFGQLSSGSWGNLM
##                      LIPSLS"
```
---

# GenBank features

**Source**: Mandatory feature in each record that summarizes the length of the sequence, scientific name of the source organism, and Taxon ID number. Can also include other information such as map location, strain, clone, tissue type, etc., if provided by submitter.



```
## Feature 1 
## 
##  type: source
## location: [0:500](+)
## qualifiers:
##     Key: collection_date, Value: ['2009']
##     Key: country, Value: ['Sweden']
##     Key: db_xref, Value: ['taxon:1313215']
##     Key: host, Value: ['Homo sapiens']
##     Key: isolate, Value: ['462']
##     Key: isolation_source, Value: ['feces']
##     Key: mol_type, Value: ['genomic RNA']
##     Key: organism, Value: ['Aichi virus 1']
```

---

# GenBank features

**Coding sequence**




```
## Feature 2 
##  type: CDS
## location: [&lt;0:&gt;500](+)
## qualifiers:
##     Key: codon_start, Value: ['3']
##     Key: product, Value: ['VP1']
##     Key: protein_id, Value: ['AFH54897.1']
##     Key: translation, Value: ['PPDTKLENFFSFYRLLPMGGSGAPALSFPADEGTIIPLNPINWLKGADVSGIAAMLSCFTYIAADLRITLRFSNPNDNPATMLVAFAPPGATIPLKPTRQMLSNFYMAEVPVSAATSTMVSFSIPYTSPLSAIPTSYFGWEDWSGTNFGQLSSGSWGNLMLIPSLS']
```

--

También puede haber información como: promoter, TATA signal, mRNA, 5'UTR, CDS, 3'UTR
---
# GenBank annotations (metadata)
Primero accedemos al atributo `features`. Aquí están almacenada la información de metadata en forma de **lista**:

```{}
registro.features
```
&lt;p&gt;&lt;samp&gt;## [ obj_SeqFeature_1,&lt;br&gt;##  obj_SeqFeature_2,&lt;br&gt;&lt;mark&gt;## SeqFeature_source]&lt;/mark&gt;&lt;br&gt;&lt;mark&gt;## SeqFeature_CDS]&lt;/mark&gt;&lt;/samp&gt;&lt;/p&gt;

--

Dentro de esta lista, tengo **objetos**  `SeqFeature`, con atributos como:

+ location : desde la base 0 hasta la base 30
+ type : source, cds, etc.
+ qualifiers : 
  + tipo de molécula, país,  ...
  + producto, id de la proteína, ...
  
---

Como es una lista, accedemos a los **objetos** `SeqFeature` como tal:

```{}
registro.features[0]
```

&lt;p&gt;&lt;samp&gt;## obj_SeqFeature_source &lt;/samp&gt;&lt;/p&gt;

```{}
registro.features[1]
```

&lt;p&gt;&lt;samp&gt;## obj_SeqFeature_CDS &lt;/samp&gt;&lt;/p&gt;

--

Al ser objetos, podemos acceder a sus atributos (type, location, qualifiers)
```{}
# location contiene un objeto FeatureLocation 
registro.features[0].location
```

&lt;p&gt;&lt;samp&gt;## obj_FeatureLocation(inicio, fin, cadena) &lt;/samp&gt;&lt;/p&gt;

```{}
# type contiene una cadena
registro.features[0].type
```

&lt;p&gt;&lt;samp&gt;## source &lt;/samp&gt;&lt;/p&gt;

---
Al ser objetos, podemos acceder a sus atributos (type, location, qualifiers)

```{}
# qualifiers contiene un diccionario
registro.features[0].qualifiers
```

&lt;p&gt;&lt;samp&gt;## {llave_qualifier_1 : valor_qualifier_1,&lt;br&gt;##  llave_qualifier_2 : valor_qualifier_2,&lt;br&gt;&lt;mark&gt;## mol_type : ['genomic RNA'], &lt;br&gt;&lt;mark&gt;## country : ['Sweden']}&lt;/mark&gt; }&lt;/mark&gt;&lt;/samp&gt;&lt;/p&gt;

```{}
# accedemos como diccionario...
registro.features[0].qualifiers['country']
```
&lt;p&gt;&lt;samp&gt;## ['Sweden'] &lt;/samp&gt;&lt;/p&gt;

---
# Resumen de features
&lt;img src="imgs/clase_2/resumen.png" width="850px" style="display: block; margin: auto;" /&gt;
---
# Acceder a los valores **qualifiers** del *feature* 


```
## Feature 2 
##  type: CDS
## location: [&lt;0:&gt;500](+)
## qualifiers:
##     Key: codon_start, Value: ['3']
##     Key: product, Value: ['VP1']
##     Key: protein_id, Value: ['AFH54897.1']
##     Key: translation, Value: ['PPDTKLENFFSFYRLLPMGGSGAPALSFPADEGTIIPLNPINWLKGADVSGIAAMLSCFTYIAADLRITLRFSNPNDNPATMLVAFAPPGATIPLKPTRQMLSNFYMAEVPVSAATSTMVSFSIPYTSPLSAIPTSYFGWEDWSGTNFGQLSSGSWGNLMLIPSLS']
```

--


```python
gb_record.features[1].qualifiers
```

```
## {'codon_start': ['3'], 'product': ['VP1'], 'protein_id': ['AFH54897.1'], 'translation': ['PPDTKLENFFSFYRLLPMGGSGAPALSFPADEGTIIPLNPINWLKGADVSGIAAMLSCFTYIAADLRITLRFSNPNDNPATMLVAFAPPGATIPLKPTRQMLSNFYMAEVPVSAATSTMVSFSIPYTSPLSAIPTSYFGWEDWSGTNFGQLSSGSWGNLMLIPSLS']}
```
---

# &lt;span style="color:Plum"&gt;Ejercicio 5&lt;/span&gt;

#### &lt;span style="color:Orchid"&gt;Obtener información de las features&lt;/span&gt;

* Utilizando el archivo **virus.gb** obtengan el número del aislado y el país de donde proviene

```python
## FEATURES             Location/Qualifiers
##      source          1..500
##                      /organism="Aichi virus 1" 
##                      /mol_type="genomic RNA"
*##                      /isolate="462"
##                      /isolation_source="feces"
##                      /host="Homo sapiens"
##                      /db_xref="taxon:1313215"
*##                      /country="Sweden"
##                      /collection_date="2009"
##      CDS             &lt;1..&gt;500
##                      /codon_start=3
##                      /product="VP1"
##                      /protein_id="AFH54897.1"
##                      /translation="PPDTKLENF...LS"
```
---
## Acceder a los valores **location** del *feature* 

```python
gb_record.features[1].location
```

```
## SimpleLocation(BeforePosition(0), AfterPosition(500), strand=1)
```

```python
gb_record.features[1].location.__dict__
```

```
## {'_start': BeforePosition(0), '_end': AfterPosition(500), '_strand': 1, 'ref': None, 'ref_db': None}
```

```python
dir(gb_record.features[1].location)
```

```
## ['__abstractmethods__', '__add__', '__class__', '__contains__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__module__', '__ne__', '__new__', '__nonzero__', '__radd__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__slots__', '__str__', '__sub__', '__subclasshook__', '__weakref__', '_abc_impl', '_end', '_flip', '_get_strand', '_set_strand', '_shift', '_start', '_strand', 'end', 'extract', 'fromstring', 'nofuzzy_end', 'nofuzzy_start', 'parts', 'ref', 'ref_db', 'start', 'strand']
```
---

Diferencia entre start, end, nofuzzy_start y nofuzzy_end

```python
gb_record.features[1].location.start
```

```
## BeforePosition(0)
```

```python
gb_record.features[1].location.nofuzzy_start
```

```
## 0
## 
## /Users/heladia/.virtualenvs/r-reticulate/lib/python3.10/site-packages/Bio/SeqFeature.py:1436: BiopythonDeprecationWarning: Use int(feature.start) rather than feature.nofuzzy_start
##   warnings.warn(
```

```python
gb_record.features[1].location.end
```

```
## AfterPosition(500)
```

```python
gb_record.features[1].location.nofuzzy_end
```

```
## 500
## 
## /Users/heladia/.virtualenvs/r-reticulate/lib/python3.10/site-packages/Bio/SeqFeature.py:1455: BiopythonDeprecationWarning: Use int(feature.end) rather than feature.nofuzzy_end
##   warnings.warn(
```

---
# Origin

&lt;img src="imgs/clase_2/origin.png" width="450px" style="display: block; margin: auto;" /&gt;
---
# Origin
Al ser un **objeto** SeqRecord, tiene los atributos *id* y *seq*. Nuestra secuencia **origin** se encuentra en en el atributo *seq* y es de tipo `Bio.Seq.Seq`

¿cómo obtengo un subset de esta secuencia del nucléotido 4 al 10?

--


```python
gb_record.seq
```

```
## Seq('TCCCTCCAGACACCAAACTGGAAAACTTCTTCTCCTTCTACCGCTTGCTGCCCA...TCT')
```

```python
gb_record.seq[3:10]
```

```
## Seq('CTCCAGA')
```

--

Ahora, ¿cómo accedo a la secuencia usando el inicio y el fin del *feature* cds?

--

```python
start = gb_record.features[1].location.nofuzzy_start
end = gb_record.features[1].location.nofuzzy_end
nueva_seq = gb_record.seq[start:end]
```

---

¿Con qué método puedo obter la proteína de esta secuencia?

--

```python
nueva_seq.translate()
```

--


```
## Feature 2 
##  type: CDS
## location: [&lt;0:&gt;500](+)
## qualifiers:
##     Key: codon_start, Value: ['3']
##     Key: product, Value: ['VP1']
##     Key: protein_id, Value: ['AFH54897.1']
##     Key: translation, Value: ['PPDTKLENFFSFYRLLPMGGSGAPALSFPADEGTIIPLNPINWLKGADVSGIAAMLSCFTYIAADLRITLRFSNPNDNPATMLVAFAPPGATIPLKPTRQMLSNFYMAEVPVSAATSTMVSFSIPYTSPLSAIPTSYFGWEDWSGTNFGQLSSGSWGNLMLIPSLS']
```

¿Notan algo con esta proteína?
---

# &lt;span style="color:Plum"&gt;Ejercicio 6&lt;/span&gt;

#### &lt;span style="color:Orchid"&gt; &lt;/span&gt;

* Utilizando el archivo **virus.gb** obtengan la secuencia, transcripción y traducción del gen **L**.

---

# &lt;span style="color:CadetBlue"&gt;Ejercicio completo&lt;/span&gt;

Creen una función que a partir del archivo virus.gb imprima:
Organismo  
País de la muestra  
Número del aislado  
Nombre del gen y de la proteína que produce (sólo hay un cds)  
Los primeros 15 nucleótidos de ADN. De estos 15 nucleótidos su respectivo ARN y proteína.

    &gt; resumen("files/clase_2/hepatitis.gb")
      # Organismo:    Hepatitis B virus
      # Fecha:    15-MAY-2012
      # País:   India 
      # Aislado:    11851
      # Gen:    X
      # ADN:    ATGGCTGCTAGGTTG
      # ARN:    AUGGCUGCUAGGUUG
      # Proteína:     MAARL
---
# Pasos del ejercicio



 1. Lee el archivo y crea tu objeto gb_record
 
 2. Puedes obtener los primeros datos de annotations (uno de ellos también aparece en features, puedes tomarlo de donde quieras).
 
 3. Revisa cómo accedimos en la clase a la información de features.
 
 4. Recuerda que la secuencia de gb_record.seq es una secuencia de Bio.Seq y puedes aprovechar sus métodos.


---

# &lt;span style="color:OrangeRed"&gt;Tarea&lt;/span&gt;

* Optimicen y documenten su código. 
* Generalicen su función resumen para que obtenga la dirección de un archivo y los genes de los cuales quiero las secuencias:

```{}
    &gt; resumen("files/clase_2/archivo.gb", genes=['X','Y'])
      # Organismo:    Hepatitis B virus
      # Fecha:    15-MAY-2012
      # País:   India 
      # Aislado:    11851
      # Gen_1:    X
      # ADN:    ATGGCTGCTAGGTTG
      # ARN:    AUGGCUGCUAGGUUG
      # Proteína:     MAARL
      # Gen_2:    Y
      # ADN:    ATGGTGCGCGCGGC
      # ARN:    ...
      # Proteína:     ...
```
---

# &lt;span style="color:OrangeRed"&gt;Tarea&lt;/span&gt;

+ Input : Nombre del archivo y lista con los nombres de los genes que buscamos

+ Output : Imprimir los datos solicitados

+ Entregable : archivo .py con la función solicitada

```{}
    &gt; resumen("files/clase_2/archivo.gb", genes=['X','Y'])
      # Organismo:    Hepatitis B virus
      # Fecha:    15-MAY-2012
      # País:   India 
      # Aislado:    11851
      # Gen_1:    X
      # ADN:    ATGGCTGCTAGGTTG
      # ARN:    AUGGCUGCUAGGUUG
      # Proteína:     MAARL
      # Gen_2:    Y
      # ADN:    ATGGTGCGCGCGGC
      # ARN:    ...
      # Proteína:     ...
```
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
  .logo {
    background-image: url(logos/LCG-UNAM.png);
    background-size: contain;
    background-repeat: no-repeat;
    position: absolute;
    top: 1em;
    right: 1em;
    width: 110px;
    height: 128px;
    z-index: 0;
  }
  </style>
  
  <script>
  document
    .querySelectorAll(
      '.remark-slide-content' +
      ':not(.title-slide)' +
      // add additional classes to exclude here, e.g.
      // ':not(.inverse)' +
      ':not(.hide-logo)'
    )
    .forEach(el => {
      el.innerHTML += '<div class="logo"></div>';
    });
  </script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
